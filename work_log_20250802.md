# PDF Text Extraction Project - 作業ログ
## 2025年8月2日

### プロジェクト概要
PDFファイルからテキストと表データを抽出し、Excel/CSV形式でエクスポートするPythonツールの開発

### 実施タスク

#### 1. 環境構築
- Python仮想環境（venv）の作成
- 必要なパッケージのインストール設定（requirements.txt）
  - tabula-py==2.9.0（表抽出用）
  - pandas==2.2.0（データ処理用）
  - PyPDF2==3.0.1（テキスト抽出用）
  - openpyxl==3.1.2（Excel出力用）

#### 2. Java環境のセットアップ
- tabula-pyの動作にJava Runtimeが必要なことが判明
- Homebrewを使用してOpenJDKをインストール
  ```bash
  brew install openjdk
  echo 'export PATH="/opt/homebrew/opt/openjdk/bin:$PATH"' >> ~/.zshrc
  ```

#### 3. PDF抽出スクリプトの開発（extract_pdf.py）
- PDFからテキスト抽出機能（PyPDF2使用）
- PDFから表データ抽出機能（tabula-py使用）
- 抽出データのExcel/CSV出力機能
- セル内改行データの自動分割処理機能

#### 4. データ処理の改善
- 問題：PDFの表で「24卒\r25卒」のように1つのセルに複数のデータが改行で入っていた
- 解決：process_table_with_newlines()関数を実装し、改行文字（\r）で分割して別々の行に展開

### 処理対象ファイル
- `pdf/【新卒】業績推移(コグナビ新卒)_202507 (1).pdf`

### 出力ファイル
- Excel形式：全データを1つのファイルに複数シートで保存
- CSV形式：各表を個別のファイルとして保存
- テキストファイル：PDFの全テキスト内容を保存

### 使用方法
```bash
# 仮想環境の有効化
source venv/bin/activate

# パッケージのインストール
pip install -r requirements.txt

# スクリプトの実行
python extract_pdf.py
```

### 今後の改善点
- エラーハンドリングの強化
- より複雑な表構造への対応
- GUIインターフェースの追加
- バッチ処理機能の実装

### 参考資料
- https://qiita.com/NAO_IW/items/06d452afb270b1cb188e（Tabula-pyの使用方法）